<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:views="clr-namespace:CdsHelper.Main.UI.Views"
                    xmlns:converters="clr-namespace:CdsHelper.Main.Local.Converters">

    <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter" />
    <converters:LevelToOpacityConverter x:Key="LevelToOpacityConverter" />
    <converters:StringToBrushConverter x:Key="StringToBrushConverter" />

    <!-- 링크 스타일 버튼 -->
    <Style x:Key="LinkButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Foreground" Value="#0066CC" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <TextBlock Text="{TemplateBinding Content}"
                               Foreground="{TemplateBinding Foreground}"
                               TextDecorations="Underline" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Foreground" Value="#003399" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="{x:Type views:PlayerContent}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type views:PlayerContent}">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!-- 상단: 파일 선택 -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                            <Button Content="세이브 파일 열기" Width="120" Height="30"
                                    Command="{Binding LoadSaveCommand}" />
                            <Button Content="새로고침" Width="80" Height="30" Margin="10,0,0,0"
                                    Command="{Binding RefreshCommand}" />
                            <TextBlock Text="{Binding FilePath}" VerticalAlignment="Center" Margin="10,0,0,0"
                                       Foreground="Gray" />
                        </StackPanel>

                        <!-- 중앙: 플레이어 정보 -->
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <!-- 왼쪽: 기본 정보 + 기능 스킬 -->
                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                    <!-- 기본 정보 -->
                                    <GroupBox Header="기본 정보" Padding="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="80" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="이름:" FontWeight="Bold" />
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Player.FullName}"
                                                       FontSize="16" FontWeight="Bold" />

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="명성:" Margin="0,5,0,0" />
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Player.Fame}" Margin="0,5,0,0" />

                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="악명:" Margin="0,5,0,0" />
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Player.Notoriety}" Margin="0,5,0,0" />

                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="현재 도시:" Margin="0,5,0,0" />
                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding Player.CurrentCityName}" Margin="0,5,0,0" />
                                        </Grid>
                                    </GroupBox>

                                    <!-- 동료 정보 -->
                                    <GroupBox Header="동료" Padding="10" Margin="0,10,0,0">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="80" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="부관:" />
                                            <Button Grid.Row="0" Grid.Column="1" Content="{Binding Player.AdjutantName}"
                                                    Command="{Binding ShowCrewMemberCommand}" CommandParameter="Adjutant"
                                                    Style="{StaticResource LinkButtonStyle}" HorizontalAlignment="Left" />

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="항해사:" Margin="0,3,0,0" />
                                            <Button Grid.Row="1" Grid.Column="1" Content="{Binding Player.NavigatorName}"
                                                    Command="{Binding ShowCrewMemberCommand}" CommandParameter="Navigator"
                                                    Style="{StaticResource LinkButtonStyle}" HorizontalAlignment="Left" Margin="0,3,0,0" />

                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="측량사:" Margin="0,3,0,0" />
                                            <Button Grid.Row="2" Grid.Column="1" Content="{Binding Player.SurveyorName}"
                                                    Command="{Binding ShowCrewMemberCommand}" CommandParameter="Surveyor"
                                                    Style="{StaticResource LinkButtonStyle}" HorizontalAlignment="Left" Margin="0,3,0,0" />

                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="통역:" Margin="0,3,0,0" />
                                            <Button Grid.Row="3" Grid.Column="1" Content="{Binding Player.InterpreterName}"
                                                    Command="{Binding ShowCrewMemberCommand}" CommandParameter="Interpreter"
                                                    Style="{StaticResource LinkButtonStyle}" HorizontalAlignment="Left" Margin="0,3,0,0" />
                                        </Grid>
                                    </GroupBox>

                                    <!-- 스킬 (기능 + 언어) -->
                                    <GroupBox Header="스킬" Padding="10" Margin="0,10,0,0">
                                        <StackPanel>
                                            <!-- 범례 -->
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                <Rectangle Width="12" Height="12" Fill="#2196F3" Margin="0,0,3,0" />
                                                <TextBlock Text="플레이어" FontSize="10" Margin="0,0,10,0" />
                                                <Rectangle Width="12" Height="12" Fill="#4CAF50" Margin="0,0,3,0" />
                                                <TextBlock Text="부관" FontSize="10" Margin="0,0,10,0" />
                                                <Rectangle Width="12" Height="12" Fill="#FF9800" Margin="0,0,3,0" />
                                                <TextBlock Text="항해사" FontSize="10" Margin="0,0,10,0" />
                                                <Rectangle Width="12" Height="12" Fill="#9C27B0" Margin="0,0,3,0" />
                                                <TextBlock Text="측량사" FontSize="10" Margin="0,0,10,0" />
                                                <Rectangle Width="12" Height="12" Fill="#F44336" Margin="0,0,3,0" />
                                                <TextBlock Text="통역" FontSize="10" />
                                            </StackPanel>

                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>

                                                <!-- 기능 스킬 -->
                                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                    <TextBlock Text="기능 스킬" FontWeight="Bold" Margin="0,0,0,5" />
                                                    <ItemsControl ItemsSource="{Binding CombinedSkills}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Grid Margin="0,2">
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="55" />
                                                                        <ColumnDefinition Width="20" />
                                                                        <ColumnDefinition Width="50" />
                                                                    </Grid.ColumnDefinitions>
                                                                    <TextBlock Grid.Column="0" Text="{Binding Name}" VerticalAlignment="Center" />
                                                                    <TextBlock Grid.Column="1" Text="{Binding BestLevel}" FontWeight="Bold" VerticalAlignment="Center" />
                                                                    <ProgressBar Grid.Column="2" Value="{Binding BestLevel, Mode=OneWay}" Maximum="3"
                                                                                 Height="12" Margin="3,0,0,0"
                                                                                 Foreground="{Binding BestColor, Converter={StaticResource StringToBrushConverter}}"
                                                                                 ToolTip="{Binding ToolTipText}" />
                                                                </Grid>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </StackPanel>

                                                <!-- 언어 스킬 -->
                                                <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                                    <TextBlock Text="언어 스킬" FontWeight="Bold" Margin="0,0,0,5" />
                                                    <ItemsControl ItemsSource="{Binding CombinedLanguages}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Grid Margin="0,2">
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="75" />
                                                                        <ColumnDefinition Width="20" />
                                                                        <ColumnDefinition Width="50" />
                                                                    </Grid.ColumnDefinitions>
                                                                    <TextBlock Grid.Column="0" Text="{Binding Name}" VerticalAlignment="Center" />
                                                                    <TextBlock Grid.Column="1" Text="{Binding BestLevel}" FontWeight="Bold" VerticalAlignment="Center" />
                                                                    <ProgressBar Grid.Column="2" Value="{Binding BestLevel, Mode=OneWay}" Maximum="3"
                                                                                 Height="12" Margin="3,0,0,0"
                                                                                 Foreground="{Binding BestColor, Converter={StaticResource StringToBrushConverter}}"
                                                                                 ToolTip="{Binding ToolTipText}" />
                                                                </Grid>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                    </GroupBox>
                                </StackPanel>

                                <!-- 오른쪽: 동료 상세 -->
                                <StackPanel Grid.Column="1" Margin="10,0,0,0">

                                    <!-- 선택된 동료 정보 -->
                                    <GroupBox Header="동료 상세" Padding="10"
                                              Visibility="{Binding SelectedCrewMember, Converter={StaticResource NullToVisibilityConverter}}">
                                        <StackPanel>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="60" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>

                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="이름:" FontWeight="Bold" />
                                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SelectedCrewMember.Name}" FontWeight="Bold" />

                                                <TextBlock Grid.Row="1" Grid.Column="0" Text="나이:" Margin="0,3,0,0" />
                                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SelectedCrewMember.Age}" Margin="0,3,0,0" />

                                                <TextBlock Grid.Row="2" Grid.Column="0" Text="소재:" Margin="0,3,0,0" />
                                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SelectedCrewMember.Location}" Margin="0,3,0,0" />

                                                <TextBlock Grid.Row="3" Grid.Column="0" Text="명성:" Margin="0,3,0,0" />
                                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedCrewMember.Fame}" Margin="0,3,0,0" />

                                                <TextBlock Grid.Row="4" Grid.Column="0" Text="체력:" Margin="0,3,0,0" />
                                                <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding SelectedCrewMember.HP}" Margin="0,3,0,0" />

                                                <TextBlock Grid.Row="5" Grid.Column="0" Text="지력:" Margin="0,3,0,0" />
                                                <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding SelectedCrewMember.Intelligence}" Margin="0,3,0,0" />

                                                <TextBlock Grid.Row="6" Grid.Column="0" Text="무력:" Margin="0,3,0,0" />
                                                <TextBlock Grid.Row="6" Grid.Column="1" Text="{Binding SelectedCrewMember.Strength}" Margin="0,3,0,0" />

                                                <TextBlock Grid.Row="7" Grid.Column="0" Text="매력:" Margin="0,3,0,0" />
                                                <TextBlock Grid.Row="7" Grid.Column="1" Text="{Binding SelectedCrewMember.Charm}" Margin="0,3,0,0" />
                                            </Grid>

                                            <TextBlock Text="특기:" FontWeight="Bold" Margin="0,10,0,3" />
                                            <TextBlock Text="{Binding SelectedCrewMember.Skills}" TextWrapping="Wrap" />
                                        </StackPanel>
                                    </GroupBox>
                                </StackPanel>
                            </Grid>
                        </ScrollViewer>

                        <!-- 하단: 상태바 -->
                        <TextBlock Grid.Row="2" Text="{Binding StatusText}" Margin="0,10,0,0" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
